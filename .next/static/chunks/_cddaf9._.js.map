{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/Nathan/Library/CloudStorage/Dropbox/Tech/projects/mapapp/app/components/layout/ThemeProvider.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport { ThemeProvider as NextThemesProvider } from \"next-themes\";\n\nexport function ThemeProvider({\n  children,\n  ...props\n}: React.ComponentProps<typeof NextThemesProvider>) {\n  return <NextThemesProvider {...props}>{children}</NextThemesProvider>;\n}\n"],"names":[],"mappings":";;;;AAGA;AAHA;;;AAKO,SAAS,cAAc,EAC5B,QAAQ,EACR,GAAG,OAC6C;IAChD,qBAAO,6LAAC,mJAAA,CAAA,gBAAkB;QAAE,GAAG,KAAK;kBAAG;;;;;;AACzC;KALgB"}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///Users/Nathan/Library/CloudStorage/Dropbox/Tech/projects/mapapp/actions/globalSettings.ts"],"sourcesContent":["\"use server\";\n\nimport db from \"@/db\";\n\n// Fetch Global Settings\nexport async function getGlobalSettings() {\n  const settings = await db.globalSettings.findFirst();\n  return settings;\n}\n"],"names":[],"mappings":";;;;;IAKsB"}},
    {"offset": {"line": 43, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///Users/Nathan/Library/CloudStorage/Dropbox/Tech/projects/mapapp/actions/adminActions.ts"],"sourcesContent":["\"use server\";\n\nimport db from \"@/db\";\nimport { requireRole } from \"@/app/lib/requireRole\";\nimport type { Session } from \"@/app/lib/auth-client\";\n\n// ✅ Update Global Settings (Admins only)\nexport async function updateGlobalSettings(session: Session, updatedSettings) {\n  requireRole(session, \"admin\");\n\n  const { id, ...settingWithoutId } = updatedSettings;\n\n  return await db.globalSettings.update({\n    where: { id: 1 },\n    data: settingWithoutId,\n  });\n}\n"],"names":[],"mappings":";;;;;IAOsB"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/Nathan/Library/CloudStorage/Dropbox/Tech/projects/mapapp/actions/getReportTypes.ts"],"sourcesContent":["\"use server\";\n\nimport db from \"../db\";\n\nexport async function getReportTypes() {\n  // Fetch the report types from the database.\n  const types = await db.reportType.findMany();\n  // Map the result to a simpler array of objects if needed.\n  return types.map((type) => ({\n    id: type.id,\n    name: type.name,\n    fields: type.fields,\n  }));\n}\n"],"names":[],"mappings":";;;;;IAIsB"}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/Nathan/Library/CloudStorage/Dropbox/Tech/projects/mapapp/actions/getReports.ts"],"sourcesContent":["\"use server\";\n\nimport db from \"../db\";\n\nexport async function getReports(timeRange: number = 4) {\n  const cutoffTime = new Date();\n  cutoffTime.setHours(cutoffTime.getHours() - timeRange);\n\n  // Fetch the report types from the database.\n  const reports = await db.report.findMany({\n    where: {\n      createdAt: {\n        gte: cutoffTime,\n      },\n    },\n    orderBy: {\n      createdAt: \"desc\",\n    },\n  });\n  // Map the result to a simpler array of objects if needed.\n  return reports;\n}\n"],"names":[],"mappings":";;;;;IAIsB"}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///Users/Nathan/Library/CloudStorage/Dropbox/Tech/projects/mapapp/app/components/layout/DataProvider.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n  ReactNode,\n  Dispatch,\n  SetStateAction,\n} from \"react\";\nimport { getGlobalSettings } from \"@/actions/globalSettings\";\nimport { updateGlobalSettings } from \"@/actions/adminActions\";\nimport { getReportTypes } from \"@/actions/getReportTypes\";\nimport { getReports } from \"@/actions/getReports\";\nimport { io } from \"socket.io-client\";\n\n// Define types for global settings, reports, report types, and user settings\ninterface GlobalSettings {\n  id: number;\n  mapCenterLat: number;\n  mapCenterLng: number;\n  mapBoundsSwLat: number;\n  mapBoundsSwLng: number;\n  mapBoundsNeLat: number;\n  mapBoundsNeLng: number;\n  registrationMode: \"open\" | \"invite\" | \"closed\";\n  inviteCodes: string;\n  mapOpenToVisitors: boolean;\n  submitReportsOpen: boolean;\n  votesOpenToVisitors: boolean;\n  mapZoom: number;\n  mapMaxZoom: number;\n  mapMinZoom: number;\n  mapApiKey: string;\n}\n\ninterface ReportType {\n  id: number;\n  name: string;\n}\n\ninterface Report {\n  id: number;\n  reportTypeId: number;\n  lat: number;\n  long: number;\n  description: string | null;\n  image: string | null;\n  createdAt: string; // Prisma usually returns ISO date strings\n  updatedAt: string;\n  departedAt: string | null;\n  trustScore: number;\n  submittedById: string;\n}\n\ninterface UserSettings {\n  theme: \"light\" | \"dark\";\n}\n\ninterface DataContextType {\n  globalSettings: GlobalSettings | null;\n  updateSettings: (session: any, newSettings: GlobalSettings) => Promise<void>;\n  reportTypes: ReportType[];\n  reports: Report[];\n  setReports: Dispatch<SetStateAction<Report[]>>;\n  userSettings: UserSettings;\n  setUserSettings: Dispatch<SetStateAction<UserSettings>>;\n  timeRange: number;\n  setTimeRange: Dispatch<SetStateAction<number>>;\n}\n\n// Provide default values for context (empty arrays, defaults for settings)\nconst DataContext = createContext<DataContextType>({\n  globalSettings: null,\n  updateSettings: async () => {}, // Temporary placeholder function\n  reportTypes: [],\n  reports: [],\n  setReports: () => {}, // Temporary placeholder function\n  userSettings: { theme: \"light\" },\n  setUserSettings: () => {}, // Temporary placeholder function\n  timeRange: 4,\n  setTimeRange: () => {}, // Temporary placeholder function\n});\n\n// Properly type the provider component\nexport const DataProvider = ({ children }: { children: ReactNode }) => {\n  const [globalSettings, setGlobalSettings] = useState<GlobalSettings | null>(\n    null\n  );\n  const [reportTypes, setReportTypes] = useState<ReportType[]>([]);\n  const [reports, setReports] = useState<Report[]>([]);\n  const [timeRange, setTimeRange] = useState<number>(4);\n  const [userSettings, setUserSettings] = useState<UserSettings>({\n    theme: \"light\",\n  });\n\n  // Fetch report types once\n  useEffect(() => {\n    async function fetchSettings() {\n      try {\n        const data = await getGlobalSettings();\n        if (!data) {\n          console.error(\"No global settings found\");\n          return;\n        }\n        setGlobalSettings(data);\n      } catch (error) {\n        console.log(\"Error fetching global settings:\", error);\n      }\n    }\n    fetchSettings();\n\n    const fetchReportTypes = async () => {\n      const types = await getReportTypes();\n      setReportTypes(types);\n    };\n    fetchReportTypes();\n\n    const socket = io(\"http://localhost:3005\"); // Adjust to match your socket server URL\n\n    socket.on(\"new-report\", (data: Report) => {\n      setReports((prevReports) => {\n        if (prevReports.some((r) => r.id === data.id)) {\n          return prevReports;\n        }\n\n        return [\n          ...prevReports,\n          {\n            ...data,\n            createdAt:\n              data.createdAt instanceof Date\n                ? data.createdAt.toISOString()\n                : data.createdAt,\n            updatedAt:\n              data.updatedAt instanceof Date\n                ? data.updatedAt.toISOString()\n                : data.updatedAt,\n            departedAt:\n              data.departedAt instanceof Date\n                ? data.departedAt.toISOString()\n                : null,\n          },\n        ];\n      });\n    });\n\n    socket.on(\"report-deleted\", ({ reportId }: { reportId: number }) => {\n      setReports((prevReports) => prevReports.filter((r) => r.id !== reportId));\n    });\n\n    return () => {\n      socket.off(\"new-report\");\n      socket.off(\"report-deleted\");\n    };\n  }, []);\n\n  useEffect(() => {\n    const storedTimeRange = localStorage.getItem(\"timeRange\");\n    if (storedTimeRange) {\n      setTimeRange(Number(storedTimeRange));\n    }\n  }, []);\n\n  useEffect(() => {\n    const fetchReports = async () => {\n      try {\n        const serverReports = await getReports(timeRange);\n\n        if (!serverReports || serverReports.length === 0) {\n          console.warn(\"⚠️ No reports found for the given time range.\");\n          setReports([]);\n          return;\n        }\n\n        // Convert Date objects to ISO strings\n        const formattedReports = serverReports.map((report) => ({\n          ...report,\n          createdAt:\n            report.createdAt instanceof Date\n              ? report.createdAt.toISOString()\n              : report.createdAt,\n          updatedAt:\n            report.updatedAt instanceof Date\n              ? report.updatedAt.toISOString()\n              : report.updatedAt,\n          departedAt:\n            report.departedAt instanceof Date\n              ? report.departedAt.toISOString()\n              : null,\n        }));\n\n        setReports(formattedReports);\n      } catch (error) {\n        console.error(\"❌ Error fetching reports:\", error);\n      }\n    };\n    fetchReports();\n\n    const interval = setInterval(fetchReports, 120000); // Fetch reports two minutes\n\n    return () => clearInterval(interval);\n  }, [timeRange]);\n\n  const updateSettings = async (session: any, newSettings: GlobalSettings) => {\n    try {\n      await updateGlobalSettings(session, newSettings);\n      setGlobalSettings(newSettings);\n    } catch (error) {\n      console.error(\"Error updating global settings:\", error);\n    }\n  };\n\n  return (\n    <DataContext.Provider\n      value={{\n        globalSettings,\n        updateSettings,\n        reportTypes,\n        reports,\n        setReports,\n        userSettings,\n        setUserSettings,\n        timeRange,\n        setTimeRange,\n      }}\n    >\n      {children}\n    </DataContext.Provider>\n  );\n};\n\n// Custom hook for easy data access\nexport const useData = () => useContext(DataContext);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 274, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 280, "column": 0}, "map": {"version":3,"sources":["file:///Users/Nathan/Library/CloudStorage/Dropbox/Tech/projects/mapapp/app/components/socketProvider.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { io, Socket } from \"socket.io-client\";\n\ninterface SocketContextType {\n  socket: Socket | null;\n}\n\ninterface Props {\n  children: React.ReactNode;\n}\nconst SocketContext = createContext<SocketContextType | null>(null);\n\nexport const SocketProvider: React.FC<Props> = ({ children }) => {\n  const [socket, setSocket] = useState<Socket | null>(null);\n\n  useEffect(() => {\n    // const socketInstance = io(\"http://localhost:3005\");  for different server websocket url\n    const socketInstance = io(\"http://localhost:3005\");\n\n    setSocket(socketInstance);\n\n    return () => {\n      socketInstance.disconnect();\n    };\n  }, []);\n\n  return (\n    <SocketContext.Provider value={{ socket }}>\n      {children}\n    </SocketContext.Provider>\n  );\n};\n\nexport const useSocket = (): Socket | null => {\n  const context = useContext(SocketContext);\n  if (!context) {\n    throw new Error(\"useSocket must be used within a SocketProvider\");\n  }\n  return context.socket;\n};\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;AAHA;;;AAYA,MAAM,8BAAgB,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD,EAA4B;AAEvD,MAAM,iBAAkC,CAAC,EAAE,QAAQ,EAAE;;IAC1D,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAEpD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,0FAA0F;YAC1F,MAAM,iBAAiB,CAAA,GAAA,kLAAA,CAAA,KAAE,AAAD,EAAE;YAE1B,UAAU;YAEV;4CAAO;oBACL,eAAe,UAAU;gBAC3B;;QACF;mCAAG,EAAE;IAEL,qBACE,6LAAC,cAAc,QAAQ;QAAC,OAAO;YAAE;QAAO;kBACrC;;;;;;AAGP;GAnBa;KAAA;AAqBN,MAAM,YAAY;;IACvB,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,QAAQ,MAAM;AACvB;IANa"}},
    {"offset": {"line": 336, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 342, "column": 0}, "map": {"version":3,"sources":["file:///Users/Nathan/Library/CloudStorage/Dropbox/Tech/projects/mapapp/components/ui/sonner.tsx"],"sourcesContent":["\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner, ToasterProps } from \"sonner\"\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n"],"names":[],"mappings":";;;;AAEA;AACA;;;AAHA;;;AAKA,MAAM,UAAU,CAAC,EAAE,GAAG,OAAqB;;IACzC,MAAM,EAAE,QAAQ,QAAQ,EAAE,GAAG,CAAA,GAAA,mJAAA,CAAA,WAAQ,AAAD;IAEpC,qBACE,6LAAC,2IAAA,CAAA,UAAM;QACL,OAAO;QACP,WAAU;QACV,cAAc;YACZ,YAAY;gBACV,OACE;gBACF,aAAa;gBACb,cACE;gBACF,cACE;YACJ;QACF;QACC,GAAG,KAAK;;;;;;AAGf;GArBM;;QACyB,mJAAA,CAAA,WAAQ;;;KADjC"}},
    {"offset": {"line": 386, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}